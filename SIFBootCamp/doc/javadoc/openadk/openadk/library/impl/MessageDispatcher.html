<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_07) on Sat Nov 19 10:16:54 GMT+08:00 2011 -->
<TITLE>
MessageDispatcher
</TITLE>

<META NAME="date" CONTENT="2011-11-19">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MessageDispatcher";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/MessageDispatcher.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../openadk/library/impl/Log4jLogSink.html" title="class in openadk.library.impl"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../openadk/library/impl/MessageDispatcher.EvDisp.html" title="class in openadk.library.impl"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?openadk/library/impl/MessageDispatcher.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MessageDispatcher.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
openadk.library.impl</FONT>
<BR>
Class MessageDispatcher</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>openadk.library.impl.MessageDispatcher</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.lang.Runnable</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>MessageDispatcher</B><DT>extends java.lang.Object<DT>implements java.lang.Runnable</DL>
</PRE>

<P>
Handles message dispatching within the class framework.<p>

  There is a MessageDispatcher object for each zone. It is protocol-independent:
  the MessageDispatcher works in conjunction with either the zone's protocol
  handler (IProtocolHandler) or its Agent Local Queue (IAgentQueue) to produce
  and consume messages, but never participates in the actual sending or
  receiving of messages on the wire. Conversely, the protocol handler and
  queue never dispatch messages; they are only concerned with sending and
  receiving them.
  <p>

  Message dispatching is at the heart of the class framework and the most
  complex implementation class because of the multiple ways in which an agent
  can exchange messages with a ZIS -- namely, Push and Pull modes, Selective
  Message Blocking, and optional Agent Local Queue (with negates the need for
  SMB when enabled). Further complicating matters is the fact that an agent
  may be connected to multiple zones, some of which may be using Push mode
  while others are using Pull mode.
  <p>

  <b>Message Acknowledgement</b><p>

  SIF guarantees the delivery (and hopefully the processing) of a message by
  requiring that it remain in its queue until acknowledged by the recipient.
  An agent should only acknowledge a message after it has processed it, so the
  ADK does not send acknowledgements when a message is received but rather
  after it has been successfully dispatched without exception. In other words,
  a message is not acknowledged simply because it was received successfully;
  it must be processed by the agent first. This is an important distinction
  to keep in mind and critical to the operation of MessageDispatcher.
  <p>

  <b>Message Consumption</b><p>

  Throughout the rest of this commentary, ALQ refers to "Agent Local Queue"
  and PH refers to "Protocol Handler".<p>

  MessageDispatcher consumes messages from one of two sources: either the ALQ
  or a zone's PH. When the ALQ is enabled, the PH stores messages in the queue
  as they are received from the network. It immediately acknowledges them
  because they are safely persisted in the ALQ and will remain there even if
  the agent goes down. Further, Selective Message Blocking is not needed when
  the ALQ is enabled, so there is no reason to ever send anything but an
  Immediate acknowledgement to the originating zone.<p>

  When the ALQ is disabled, however, messages must be dispatched and processed
  before the PH can return an acknowledgement to the zone. This means a full
  cycle through the class framework from the time a message is received by
  the PH until the time it has been processed and a SIF_Ack is returned. To
  complicate matters, an agent may need to invoke Selective Message Blocking
  because the ALQ is not available, and in this case the framework may need
  to return an Intermediate ack before the agent has had a chance to fully
  process the message.<p>

  Thus, when ALQ is enabled MessageDispatcher runs in a thread to consume
  messages from the queue as follows:<p>

  <ul>
      <li>Waits for the next message to become available (blocks)</li>
      <li>Dispatches the message to the appropriate Subscriber, Publisher,
          or QueryResults object</li>
      <li>If an exception is thrown during the dispatch call, the message is
          left in the ALQ and the process repeats</li>
      <li>If the dispatch call succeeds, the message is permanently removed
          from the ALQ</li>
  </ul>

  Remember, each message in the ALQ was acknowledged at the time it was placed
  into the queue by the PH so the above algorithm never sends SIF_Ack messages.
  It is purely concerned with dispatching messages waiting in the queue.<p>

  When ALQ is disabled MessageDispatcher does not run in a thread. Rather
  than <i>consume</i> messages, it is handed them by the PH for synchronous
  processing as they're received from the network. This process works as
  follows:<p>

  <ul>
      <li>The PH receives a message and calls MessageDispatcher.dispatch
          to dispatch it</li>
      <li>The message is dispatched to the appropriate Subscriber, Publisher,
          or QueryResults object</li>
      <li>If an exception is thrown during the dispatch call, the exception
          is propagated up the call stack to the PH, which will respond by
          simply not sending an acknowledgement. Thus, the message is left in
          the agent queue on the zone server.</li>
      <li>If the dispatch call succeeds, it returns a status code 1, 2, or 3
          to the PH and the PH sends an acknowledgement with that status code.
          These codes corresponding to the Immediate, Intermediate, and Final
          acknowledgement types. Status code 2 (Intermediate) is only returned
          if the message was dispatched to a Subscriber. Status code 3 (Final)
          is only returned if the message was dispatched to a QueryResults
          object in response to an earlier SIF_Event that invoked Selective
          Message Blocking. Status code 1 (Immediate) is returned in all other
          cases. Note MessageDispatcher <b>does not</b> keep track of SMB
          state; this is the job of the dispatch recipient.</li>
  </ul>

  <b>Message Production</b><p>

  MessageDispatcher also "produces" messages on behalf of Topic and Zone
  objects when posting outgoing SIF_Event, SIF_Request, and SIF_Response
  messages (these are the only outgoing infrastructure messages that pass
  through MessageDispatcher; all others are immediately handed to the PH for
  synchronous delivery). Like message consumption, the process of sending
  messages depends on whether or not the ALQ is enabled as well as the type of
  message being sent.<p>

  When the ALQ is enabled, SIF_Event messages are immediately stored in the
  queue and will eventually be sent to the appropriate PH by a worker thread
  that is built into the ALQ. This ensures that regardless of whether the
  agent goes down or not, the events it has generated are guaranteed to make
  their way to the ZIS eventually. SIF_Request and SIF_Response messages are
  not handled in this way; rather, they are sent synchronously in the same
  way as SIF_Events are sent when the ALQ is disabled.<p>

  When the ALQ is disabled, SIF_Event, SIF_Request, and SIF_Response messages
  are immediately handed to the PH of each destination zone. If an exception
  occurs before the message is acknowledged by the ZIS, it will propagate up
  the call stack to the agent code that originally initiated the message (e.g.
  to a Topic.publishEvent call). An agent can either retry the operation by
  calling the same method a second time, or can abandon the transaction
  altogether.<p>

  <b>Push vs. Pull Mode</b><p>

  Push and Pull mode have no effect on MessageDispatcher, its interfaces, or
  its logic. When Push mode is active for a zone, the PH will receive incoming
  messages as they're pushed by the ZIS. Those messages will then be handled
  as described in "Message Consumption" above. When Pull mode is active for a
  zone, the PH runs as a thread to periodically get messages from the ZIS. In
  short, MessageDispatcher does not care how messages were obtained. It works
  consistently in both modes.<p>

  <b>Selective Message Blocking</b><p>

  The ADK addresses Selective Message Blocking by forcing agents to use the
  TrackQueryResults class to perform queries while processing SIF_Events. (If
  an agent attempts to call a query method while a SIF_Event is being
  dispatched for a given zone, an exception is thrown.)  TrackQueryResults
  houses all of the logic for Selective Message Blocking. When the ALQ is
  enabled, TrackQueryResults does not invoke SMB; instead it draws upon the
  ALQ for SIF_Responses. When the ALQ is disabled, TrackQueryResults keeps
  a tab of which messages it has sent Intermediate acknowledgements for and
  will eventually need to send Final acknowledgements for. To accomplish this
  it works closely with MessageDispatcher so that when the dispatching of a
  given SIF_Event has ended the TrackQueryResults object is asked to send its
  pending Final acknowledgements. For more details on this consult that
  class.
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>ADK 1.0</DD>
<DT><B>Author:</B></DT>
  <DD>Eric Petersen</DD>
</DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.EvDisp.html" title="class in openadk.library.impl">MessageDispatcher.EvDisp</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EvDisp thread handles a single dispatch request.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.MessageIdCache.html" title="class in openadk.library.impl">MessageDispatcher.MessageIdCache</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#MessageDispatcher(openadk.library.impl.ZoneImpl)">MessageDispatcher</A></B>(<A HREF="../../../openadk/library/impl/ZoneImpl.html" title="class in openadk.library.impl">ZoneImpl</A>&nbsp;zone)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructs a MessageDispatcher for a zone</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#dispatch(openadk.library.SIFMessagePayload)">dispatch</A></B>(<A HREF="../../../openadk/library/SIFMessagePayload.html" title="class in openadk.library">SIFMessagePayload</A>&nbsp;msg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dispatch a message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#pull()">pull</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Poll the ZIS for messages pending in the agent's queue.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#run()">run</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;openadk.library.infra.SIF_Security</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#secureChannel()">secureChannel</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;openadk.library.infra.SIF_Ack</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#send(openadk.library.SIFMessagePayload)">send</A></B>(<A HREF="../../../openadk/library/SIFMessagePayload.html" title="class in openadk.library">SIFMessagePayload</A>&nbsp;msg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sends a message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;openadk.library.infra.SIF_Ack</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#send(openadk.library.SIFMessagePayload, boolean)">send</A></B>(<A HREF="../../../openadk/library/SIFMessagePayload.html" title="class in openadk.library">SIFMessagePayload</A>&nbsp;msg,
     boolean&nbsp;isPullMessage)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../openadk/library/impl/MessageDispatcher.html#shutdown()">shutdown</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="MessageDispatcher(openadk.library.impl.ZoneImpl)"><!-- --></A><H3>
MessageDispatcher</H3>
<PRE>
public <B>MessageDispatcher</B>(<A HREF="../../../openadk/library/impl/ZoneImpl.html" title="class in openadk.library.impl">ZoneImpl</A>&nbsp;zone)
                  throws <A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A></PRE>
<DL>
<DD>Constructs a MessageDispatcher for a zone
<P>
<DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A></CODE></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="dispatch(openadk.library.SIFMessagePayload)"><!-- --></A><H3>
dispatch</H3>
<PRE>
public int <B>dispatch</B>(<A HREF="../../../openadk/library/SIFMessagePayload.html" title="class in openadk.library">SIFMessagePayload</A>&nbsp;msg)
             throws <A HREF="../../../openadk/library/SIFException.html" title="class in openadk.library">SIFException</A>,
                    <A HREF="../../../openadk/library/ADKMessagingException.html" title="class in openadk.library">ADKMessagingException</A>,
                    <A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A>,
                    <A HREF="../../../openadk/library/impl/LifecycleException.html" title="class in openadk.library.impl">LifecycleException</A></PRE>
<DL>
<DD>Dispatch a message.<p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>msg</CODE> - The infrastructure message to dispatch
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../openadk/library/SIFException.html" title="class in openadk.library">SIFException</A></CODE>
<DD><CODE><A HREF="../../../openadk/library/ADKMessagingException.html" title="class in openadk.library">ADKMessagingException</A></CODE>
<DD><CODE><A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A></CODE>
<DD><CODE><A HREF="../../../openadk/library/impl/LifecycleException.html" title="class in openadk.library.impl">LifecycleException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="send(openadk.library.SIFMessagePayload)"><!-- --></A><H3>
send</H3>
<PRE>
public openadk.library.infra.SIF_Ack <B>send</B>(<A HREF="../../../openadk/library/SIFMessagePayload.html" title="class in openadk.library">SIFMessagePayload</A>&nbsp;msg)
                                   throws <A HREF="../../../openadk/library/ADKMessagingException.html" title="class in openadk.library">ADKMessagingException</A>,
                                          <A HREF="../../../openadk/library/ADKTransportException.html" title="class in openadk.library">ADKTransportException</A></PRE>
<DL>
<DD>Sends a message.<p>

  If the message is a SIF_Event or SIF_Response message it is persisted to
  the Agent Local Queue (if enabled) to ensure reliable delivery. The
  message is then sent. Upon successful delivery to the ZIS, the message
  is removed from the queue. For all other message types the message is
  sent immediately without being posted to the queue.
  <p>

  If an exception occurs and a message has been persisted to the queue,
  it is removed from the queue if possible (the queue is operational) and
  the send operation fails.
  <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../openadk/library/ADKMessagingException.html" title="class in openadk.library">ADKMessagingException</A></CODE>
<DD><CODE><A HREF="../../../openadk/library/ADKTransportException.html" title="class in openadk.library">ADKTransportException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="send(openadk.library.SIFMessagePayload, boolean)"><!-- --></A><H3>
send</H3>
<PRE>
public openadk.library.infra.SIF_Ack <B>send</B>(<A HREF="../../../openadk/library/SIFMessagePayload.html" title="class in openadk.library">SIFMessagePayload</A>&nbsp;msg,
                                          boolean&nbsp;isPullMessage)
                                   throws <A HREF="../../../openadk/library/ADKMessagingException.html" title="class in openadk.library">ADKMessagingException</A>,
                                          <A HREF="../../../openadk/library/ADKTransportException.html" title="class in openadk.library">ADKTransportException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../openadk/library/ADKMessagingException.html" title="class in openadk.library">ADKMessagingException</A></CODE>
<DD><CODE><A HREF="../../../openadk/library/ADKTransportException.html" title="class in openadk.library">ADKTransportException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="pull()"><!-- --></A><H3>
pull</H3>
<PRE>
public int <B>pull</B>()
         throws <A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A>,
                <A HREF="../../../openadk/library/impl/LifecycleException.html" title="class in openadk.library.impl">LifecycleException</A></PRE>
<DL>
<DD>Poll the ZIS for messages pending in the agent's queue.
 <p>
 
 This method is typically called by a ProtocolHandler thread to perform a
 periodic pull when the agent is running in pull mode. It may also be
 called by the framework to force a pull if the framework requires an
 immediate response to a message it has sent to the ZIS, such as a request
 for SIF_ZoneStatus.
 <p>
 
 If a message is retrieved from the ZIS, it is dispatched through the
 ADK's usual message routing mechanism just as pushed messages are. Thus,
 there is no difference between push and pull mode once a message has been
 obtained from the ZIS. Because message routing is asynchronous (i.e. the
 MessageDispatcher will forward the message to the appropriate framework
 or agent code), this method does not return a value. If an error is
 returned in the SIF_Ack, the agent's FaultListener will be notified if
 one is registered. If an exception occurs, it is thrown to the caller.
 <p>
 
 Each time this method is invoked it sends a SIF_GetMessage to the ZIS.
 Calling this method repeatedly until 0 or -1 is returned effectively
 empties out the agent's queue.
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>threadRunLimit</CODE> - limits the number of milliseconds this method will execute.
            Messages are repeatedly pulled until the time limit is
            exceeded or there are no more messages available. 0 means no
            time limit.
<DT><B>Returns:</B><DD>zero if no messages were waiting in the agent's queue; 1 if a
         message was pulled from the agent's queue; -1 if the zone is
         sleeping.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A></CODE>
<DD><CODE><A HREF="../../../openadk/library/impl/LifecycleException.html" title="class in openadk.library.impl">LifecycleException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="secureChannel()"><!-- --></A><H3>
secureChannel</H3>
<PRE>
public openadk.library.infra.SIF_Security <B>secureChannel</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="shutdown()"><!-- --></A><H3>
shutdown</H3>
<PRE>
public void <B>shutdown</B>()
              throws <A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../openadk/library/ADKException.html" title="class in openadk.library">ADKException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="run()"><!-- --></A><H3>
run</H3>
<PRE>
public void <B>run</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>run</CODE> in interface <CODE>java.lang.Runnable</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/MessageDispatcher.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../openadk/library/impl/Log4jLogSink.html" title="class in openadk.library.impl"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../openadk/library/impl/MessageDispatcher.EvDisp.html" title="class in openadk.library.impl"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?openadk/library/impl/MessageDispatcher.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MessageDispatcher.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
